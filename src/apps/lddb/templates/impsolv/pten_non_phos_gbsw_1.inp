* GENERATED BY CHARMM-GUI (http://www.charmm-gui.org) VERSION on Dec, 14. 2013.
* Calculate energy and run simulations with GBSW implicit solvation model
* References:
* W. Im, M.S. Lee, and C.L. Brooks III, J. Comput. Chem. 24:1691-1702 (2003)
* J. Chen, W. Im, and C.L. Brooks III, J. Am. Chem. Soc. 128:3728-3736 (2006)
*

! Read topology and parameter files
stream toppar.str

! Read PSF
open read unit 10 card name step1_pdbreader.psf
read psf  unit 10 card

! Read COOR
open read unit 10 card name step1_pdbreader.pdb
read coor unit 10 pdb  resid

!
! GBSW setup
!

prnlev 0
stream toppar/radii_prot_na.str
stream toppar/radius_gbsw.str
prnlev 5

!double check if some heavy atoms have a zero radius
scalar wmain statistics select .not. type H* end
define check select ( .not. type H* ) .and. ( property wmain .eq. 0.0 ) show end
if ?nsel ne 0 stop

gbsw sgamma 0.005 nang 50

nbond atom switch cdie vdw vswitch ctonnb 16.0 ctofnb 16.0 cutnb 20.0

ENERGY

!
! short minimization and Langevin dynamics
! NOTE: CHANGE ISEED EACH TIME FOR RESTART IN LANGEVIN DYNAMICS
!

mini   sd nstep 50 nprint 10 step 0.005 inbfrq -1
mini abnr nstep 50 nprint 10 step 0.005 inbfrq -1

set fbeta = 5.0
set temp  = 300.0

scalar fbeta set @fbeta
scalar fbeta set 0.0    select type H* end

shake bonh param fast

! 10 ns
open write unit 12 card name pten_wt_unphos_1.rst
open write unit 13 file name pten_wt_unphos_1.dcd
DYNAMICS LANGEVIN      start          nstep  5000000 timestp 0.002  -
         nprint   100  iprfrq   5000  isvfrq   5000  ntrfrq    500 -
         inbfrq    -1  imgfrq     -1  ihbfrq      0  ilbfrq      0 -
         firstt @temp  finalt  @temp  iseed 47858436 -
         tbath  @temp  rbuf      0.0  -
         iunread   -1  iunwrite   12  iuncrd     13  iunvelo    -1 -
         nsavcrd  500  nsavvelo    0  -
         iasvel     1


ENERGY

open write card unit 10 name pten_wt_unphos_1.pdb
write coor pdb  unit 10

stop
