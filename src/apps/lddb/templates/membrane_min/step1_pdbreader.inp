* GENERATED BY CHARMM-GUI (http://www.charmm-gui.org) on Aug, 19. 2013.
* READ PDB, MANIPULATE STRUCTURE IF NEEDED, AND GENERATE TOPOLOGY FILE
*

! Read topology and parameter files
stream toppar.str

! Read PROA
open read card unit 10 name {protein_pdb}
read sequence pdb unit 10
generate PROA setup warn first NTER last CTER

open read card unit 10 name {protein_pdb}
read coor pdb  unit 10 resid

!Print heavy atoms with unknown coordinates
coor print sele ( .not. INIT ) .and. ( .not. hydrogen ) end

ic param
ic build
prnlev 0
hbuild
prnlev 5

ENERGY

open write card unit 10 name step1_pdbreader.pdb
write coor pdb  unit 10 official

open write card unit 10 name step1_pdbreader.crd
write coor unit 10 card

open write unit 10 card name step1_pdbreader.psf
write psf  unit 10 card

open write unit 10 card name step1_pdbreader.xplor_ext.psf
write psf  xplo unit 10 card

ioformat noext
open write unit 10 card name step1_pdbreader.xplor.psf
write psf  xplo unit 10 card

! solvent accessible surface
coor surf sele .not. resname TIP3 end rprobe 1.6 accuracy 0.05 acce

coor stat sele all end

open write unit 90 card name step1_pdbreader.str
write title unit 90
* set ncharge = ?cgtot
* set xmax = ?xmax
* set ymax = ?ymax
* set zmax = ?zmax
* set xmin = ?xmin
* set ymin = ?ymin
* set zmin = ?zmin
*

stop
