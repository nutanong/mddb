* GENERATED BY CHARMM-GUI (http://www.charmm-gui.org) VERSION on Dec, 14. 2013.
* Calculate energy and run simulations with GBSWmemb implicit solvation model
* References:
* W. Im, M.S. Lee, and C.L. Brooks III, J. Comput. Chem. 24:1691-1702 (2003).
* W. Im, M. Feig, and C.L. Brooks III, Biophys. J. 85:2900-2918 (2003).
*

! Read topology and parameter files
stream toppar.str

! Read PSF
open read unit 10 card name step1_pdbreader.psf
read psf  unit 10 card

! Read COOR
open read unit 10 card name step1_pdbreader.pdb
read coor unit 10 pdb  resid

print coor sele (ires 227 .and. type CA) .or. -
                 (ires 43  .and. type CA) .or. -
                 (ires 75  .and. type CA) end

coor stat sele type CA end
coor orient sele (ires 227 .and. type CA) .or. -
                 (ires 43  .and. type CA) .or. -
                 (ires 75  .and. type CA) end

print coor sele (ires 227 .and. type CA) .or. -
                 (ires 43  .and. type CA) .or. -
                 (ires 75  .and. type CA) end

coor trans zdir -20.0 sele all end

print coor sele (ires 227 .and. type CA) .or. -
                 (ires 43  .and. type CA) .or. -
                 (ires 75  .and. type CA) end

coor stat sele (ires 227 .and. type CA) .or. -
               (ires 43  .and. type CA) .or. -
               (ires 75  .and. type CA) end

coor stat sele type CA end

!
! GBSWmemb setup
!
! tmemb  : thickness of membrane in Ang ( membrane hydrophobic thickness = tmemb - 2*msw)
! msw    : half membrane switching length in Ang
! sgamma : surface tension coefficent for nonpolar solvation energy in kcal/mol/Ang**2
!

prnlev 0
stream toppar/radii_prot_na.str
stream toppar/radius_gbsw.str
prnlev 5

!double check if some heavy atoms have a zero radius
scalar wmain statistics select .not. type H* end
define check select ( .not. type H* ) .and. ( property wmain .eq. 0.0 ) show end
if ?nsel ne 0 stop

!  (was)  :   sw 0.3 rmax 20.0 nang 38 sgamma 0.04 tmemb 30 msw 2.5 -
GBSW  sw 0.3 sgamma 0.03 dgp 1.5 tmemb 35.0 msw 3 -
     gouy anfr 0.3 conc 0.1 temp 298 area 70 offset 3 volt 0

nbond atom switch cdie vdw vswitch ctonnb 16.0 ctofnb 16.0 cutnb 20.0

ENERGY

!
! short minimization and Langevin dynamics
! NOTE: CHANGE ISEED EACH TIME FOR RESTART IN LANGEVIN DYNAMICS
!

mini   sd nstep 50 nprint 10 step 0.005 inbfrq -1
mini abnr nstep 50 nprint 10 step 0.005 inbfrq -1

set fbeta = 5.0
set temp  = 300.0

scalar fbeta set @fbeta
scalar fbeta set 0.0    select type H* end

shake bonh param fast

! 5,000,000 is 10 ns w/2fs timestep
open write unit 12 card name pten_wt_charged_membrane_1.rst
open write unit 13 file name pten_wt_charged_membrane_1.dcd
DYNAMICS LANGEVIN      start          nstep 5000000  timestp 0.002  -
         nprint   100  iprfrq   5000  isvfrq   5000  ntrfrq    500 -
         inbfrq    -1  imgfrq     -1  ihbfrq      0  ilbfrq      0 -
         firstt @temp  finalt  @temp  iseed 47858436 -
         tbath  @temp  rbuf      0.0  -
         iunread   -1  iunwrite   12  iuncrd     13  iunvelo    -1 -
         nsavcrd  500  nsavvelo    0  -
         iasvel     1

ENERGY

open write card unit 10 name pten_wt_charged_membrane_1.pdb
write coor pdb  unit 10

stop
